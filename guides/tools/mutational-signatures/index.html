



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <script src="//assets.adobedtm.com/launch-EN942f79c83ff84c10a45b4856a85eaccb.min.js" async></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-107924368-1"></script>
    <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-107924368-1")</script>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://www.stjude.cloud/docs/guides/tools/mutational-signatures/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.4, mkdocs-material-2.9.2">
    
    
      
        <title>Mutational Signatures - St. Jude Cloud Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.4eccddb4.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.20ef595d.js"></script>

      <!-- Adobe Analytics -->
      <script src="//assets.adobedtm.com/launch-EN942f79c83ff84c10a45b4856a85eaccb.min.js" async></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#overview" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.stjude.cloud/docs/" title="St. Jude Cloud Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../../images/stjude-logo-child-white.png" width="40" height="28">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                St. Jude Cloud Documentation
              </span>
              <span class="md-header-nav__topic">
                Mutational Signatures
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/stjudecloud/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      stjudecloud/docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../../images/stjude-logo-child-white.png" width="48" height="48">
      
    </span>
    St. Jude Cloud Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/stjudecloud/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      stjudecloud/docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Welcome to St. Jude Cloud" class="md-nav__link">
      Welcome to St. Jude Cloud
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../create-an-account/" title="Create An Account" class="md-nav__link">
      Create An Account
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Data Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Data Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/about-our-data/" title="About Our Data" class="md-nav__link">
      About Our Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/data-request/" title="Making a Data Request" class="md-nav__link">
      Making a Data Request
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/working-with-our-data/" title="Working with Our Data" class="md-nav__link">
      Working with Our Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/creating-a-cloud-app/" title="Creating a Cloud App" class="md-nav__link">
      Creating a Cloud App
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/data-transfer-app/" title="Data Transfer Application" class="md-nav__link">
      Data Transfer Application
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/command-line/" title="Command Line Interaction" class="md-nav__link">
      Command Line Interaction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tool Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tool Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../pecan-pie/" title="Pecan PIE" class="md-nav__link">
      Pecan PIE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../neoepitope/" title="NeoepitopePred" class="md-nav__link">
      NeoepitopePred
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../chipseq/" title="ChIP-Seq Peak Calling" class="md-nav__link">
      ChIP-Seq Peak Calling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rapid-rnaseq/" title="Rapid RNA-Seq Fusion Detection" class="md-nav__link">
      Rapid RNA-Seq Fusion Detection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../warden/" title="WARDEN Differential Expression Analysis" class="md-nav__link">
      WARDEN Differential Expression Analysis
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Mutational Signatures
      </label>
    
    <a href="./" title="Mutational Signatures" class="md-nav__link md-nav__link--active">
      Mutational Signatures
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" title="Getting started" class="md-nav__link">
    Getting started
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-configuration" title="Input configuration" class="md-nav__link">
    Input configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-data" title="Uploading data" class="md-nav__link">
    Uploading data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-of-results" title="Analysis of results" class="md-nav__link">
    Analysis of results
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interpreting-results" title="Interpreting results" class="md-nav__link">
    Interpreting results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cis-x/" title="" class="md-nav__link">
      
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Visualization Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Visualization Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../portals/pecan/" title="PeCan Data Portal" class="md-nav__link">
      PeCan Data Portal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../portals/genome-paint/" title="Genome Paint" class="md-nav__link">
      Genome Paint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../portals/sickle-cell/" title="Sickle Cell Genomics Portal" class="md-nav__link">
      Sickle Cell Genomics Portal
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Forms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Forms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../forms/how-to-fill-out-DAA/" title="Filling out a Data Access Agreement" class="md-nav__link">
      Filling out a Data Access Agreement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../forms/how-to-fill-out-Extension/" title="Filling out an Extension Addendum" class="md-nav__link">
      Filling out an Extension Addendum
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../citing-stjude-cloud/" title="Citing St. Jude Cloud" class="md-nav__link">
      Citing St. Jude Cloud
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../faq/" title="Frequently Asked Questions" class="md-nav__link">
      Frequently Asked Questions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" title="Getting started" class="md-nav__link">
    Getting started
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-configuration" title="Input configuration" class="md-nav__link">
    Input configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-data" title="Uploading data" class="md-nav__link">
    Uploading data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-of-results" title="Analysis of results" class="md-nav__link">
    Analysis of results
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interpreting-results" title="Interpreting results" class="md-nav__link">
    Interpreting results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/stjudecloud/docs/edit/master/docs/guides/tools/mutational-signatures.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Mutational Signatures</h1>
                
                <table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Authors</strong></td>
<td>Scott Newman, Michael Macias</td>
</tr>
<tr>
<td><strong>Publication</strong></td>
<td>Mutational Signatures employs MutationalPatterns: "<a href="https://doi.org/10.1186/s13073-018-0539-0">MutationalPatterns: comprehensive genome-wide analysis of mutational processes.</a>"</td>
</tr>
<tr>
<td><strong>Technical Support</strong></td>
<td><a href="https://stjude.cloud/contact">Contact Us</a></td>
</tr>
</tbody>
</table>
<p><strong>Mutational Signatures</strong> finds and quantifies COSMIC mutational signatures
across samples. This is done by finding the optimal non-negative linear
combination of mutation signatures to reconstruct a mutation matrix. It
builds the initial mutation matrix from multiple single-sample VCFs and, by
default, fits it to <a href="https://cancer.sanger.ac.uk/cosmic/signatures">mutational signatures from COSMIC</a>. Mutational
Signatures employs <a href="https://bioconductor.org/packages/release/bioc/html/MutationalPatterns.html">MutationalPatterns</a> (<a href="#references">Blokzijl, et al. (2018)</a>) to
achieve this.</p>
<p>Mutational Signatures supports both hg19 (GRCh37) and hg38 (GRCh38).</p>
<h2 id="overview">Overview</h2>
<h3 id="inputs">Inputs</h3>

<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#vcfs">VCF(s)</a></td>
<td>Array of files</td>
<td>List of VCF inputs. Can be single-sample or multi-sample and uncompressed or gzipped.</td>
<td>[<code class="codehilite"><span class="err">*.vcf</span></code>, <code class="codehilite"><span class="err">*.vcf.gz</span></code>]</td>
</tr>
<tr>
<td><a href="#sample-sheet">Sample sheet</a></td>
<td>File</td>
<td>Tab-delimited file (no headers) with sample ID and tag pairs [optional]</td>
<td><code class="codehilite"><span class="err">*.txt</span></code></td>
</tr>
<tr>
<td>Genome build</td>
<td>String</td>
<td>Genome build used as reference. Can be either "GRCh37" or "GRCh38". [default: "GRCh38"]</td>
<td>GRCh38</td>
</tr>
<tr>
<td>Minimum mutation burden</td>
<td>Integer</td>
<td>Minimum number of somatic SNVs a sample must have to be considered for analysis [default: 9]</td>
<td>15</td>
</tr>
<tr>
<td>Minimum signature contribution</td>
<td>Integer</td>
<td>Minimum number of mutations attributable to a single signature [default: 9]</td>
<td>100</td>
</tr>
<tr>
<td><a href="#output-prefix">Output prefix</a></td>
<td>String</td>
<td>Prefix to append to output filenames [optional]</td>
<td>mtsg</td>
</tr>
<tr>
<td><a href="#disabled-vcf-column">Disabled VCF column</a></td>
<td>Integer</td>
<td>VCF column (starting from sample names, zero-based) to ignore when reading VCFS [optional]</td>
<td>1</td>
</tr>
</tbody>
</table>
<h3 id="outputs">Outputs</h3>

<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#raw-signatures">Raw signatures</a></td>
<td>File</td>
<td>Tab-delimited file of the raw results with sample contributions for each signature</td>
</tr>
<tr>
<td><a href="#signatures-visualization">Signatures visualization</a></td>
<td>File</td>
<td>HTML file for interactive plotting</td>
</tr>
<tr>
<td><a href="#sample-sheet-out">Sample sheet</a></td>
<td>File</td>
<td>Tab-delimited file (no headers) with sample ID and tag pairs</td>
</tr>
</tbody>
</table>
<h3 id="process">Process</h3>

<p>Mutational Signatures runs four steps using subcommands of <a href="https://github.com/stjude/mtsg">mtsg</a>.</p>
<ol>
<li>Split VCFs (single or multi-sample) to multiple single-sample VCFs.</li>
<li>If not given, generate a sample sheet from the directory of single-sample
     VCFs.</li>
<li>Build a mutation matrix and reconstruct/fit it using COSMIC mutation
     signatures.</li>
<li>Create a visualization file using the fitted signatures.</li>
</ol>
<h2 id="getting-started">Getting started</h2>
<p>After logging in, click the "Start" button on the <a href="https://platform.stjude.cloud/tools/mutational_signatures">Mutational Signatures tool
page</a>. This creates a new DNAnexus project and imports the tool.</p>
<p>With subsequent runs, the sidebar shows "Launch Tool", meaning the project with
the tool already exists. Click "Launch Tool" to start a new analysis.</p>
<h3 id="input-configuration">Input configuration</h3>
<p>Mutational Signatures only requires VCFs as inputs. This can be a single
multi-sample VCF, multiple single-sample VCFs, or a combination of both. All
other inputs are optional.</p>
<p>Input files can be uploaded via the <a href="../../data/data-transfer-app/">data transfer application</a> or <a href="../../data/command-line/">command
line</a>.</p>
<h4 id="vcfs">VCF(s)</h4>

<p><em>VCF(s)</em> is a list of VCF inputs. The inputs can be single-sample or
multi-sample and uncompressed or gzipped. Sample names are taken from the VCF
header.</p>
<p>When using multi-sample VCFs, empty cells/absent variant calls must be
denoted with <code class="codehilite"><span class="err">.:.</span></code>.</p>
<p>gVCFs are not supported.</p>
<h4 id="sample-sheet">Sample sheet</h4>

<p><em>Sample sheet</em> is a tab-delimited file (no headers) with two columns: the
sample ID and a tag. The tag is an arbitrary identifier used to group the
samples, typically a disease abbreviation or tissue of origin.</p>
<p>If not given, a sample sheet will be generated automatically.</p>
<h5>Example</h5>

<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>SJACT001_D</td>
<td>ACT</td>
</tr>
<tr>
<td>SJACT002_D</td>
<td>ACT</td>
</tr>
<tr>
<td>SJBALL063_D</td>
<td>BALL</td>
</tr>
<tr>
<td>SJHGG017_D</td>
<td>HGG</td>
</tr>
</tbody>
</table>
<h4 id="output-prefix">Output prefix</h4>

<p><em>Output prefix</em> is the prefix to append to the output filenames. By default,
if a single input VCF is given, its basename is used as the output prefix. If
multiple input VCFs are given, a default "mtsg" prefix is used. This behavior
can be overridden by a user-defined prefix.</p>
<h5>Example</h5>

<table>
<thead>
<tr>
<th>VCF(s)</th>
<th>Prefix</th>
<th>Output filename for raw signatures</th>
</tr>
</thead>
<tbody>
<tr>
<td>[<code class="codehilite"><span class="err">pcgp.b38.refseq.goodbad.vcf</span></code>]</td>
<td>pcgp.b38.refseq.goodbad</td>
<td><code class="codehilite"><span class="err">pcgp.b38.refseq.goodbad.signatures.txt</span></code></td>
</tr>
<tr>
<td>[<code class="codehilite"><span class="err">SJOS013_D.vcf</span></code>, <code class="codehilite"><span class="err">SJRHB007_D.vcf</span></code>]</td>
<td>mtsg</td>
<td><code class="codehilite"><span class="err">mtsg.signatures.txt</span></code></td>
</tr>
</tbody>
</table>
<h4 id="disabled-vcf-column">Disabled VCF column</h4>

<p><em>Disabled VCF column</em> is the column index to ignore when reading VCFs. This
is useful when the inputs are tumor-normal VCFs, and one column should be
ignored. Otherwise, the results would likely be duplicated.</p>
<p>The argument is a zero-based index relative to the sample names in the header
of the VCF. For example, in a VCF with samples <code class="codehilite"><span class="err">SJEPD003_D</span></code> and <code class="codehilite"><span class="err">SJEPD003_G</span></code>,
the germline sample (<code class="codehilite"><span class="err">SJEPD003_G</span></code>) can be discarded by setting the <em>disabled
VCF column</em> to <code class="codehilite"><span class="err">1</span></code>.</p>
<h5>Example</h5>

<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th>0</th>
<th>1</th>
</tr>
</thead>
<tbody>
<tr>
<td>#CHROM</td>
<td>POS</td>
<td>ID</td>
<td>REF</td>
<td>ALT</td>
<td>QUAL</td>
<td>FILTER</td>
<td>INFO</td>
<td>FORMAT</td>
<td>SJEPD003_D</td>
<td>SJEPD003_G</td>
</tr>
</tbody>
</table>
<h2 id="uploading-data">Uploading data</h2>
<p>Mutational Signatures requires at least one VCF and an optional sample sheet
to be uploaded. These files can be uploaded via the <a href="../../data/data-transfer-app/">data transfer
application</a> or <a href="../../data/command-line/">command line</a>.</p>
<h2 id="analysis-of-results">Analysis of results</h2>
<p>Upon a successful run of Mutational Signatures, three files are saved to the
results directory: raw signature contributions, a visualization file, and a
sample sheet.</p>
<h3 id="interpreting-results">Interpreting results</h3>
<h4 id="raw-signatures">Raw signatures</h4>

<p><em>Raw signatures</em> is a tab-delimited file of the raw results with sample
contributions for each signature. Column 1 is the sample name, columns
2-(N-1) are the COSMIC signatures contribution counts, and column N is the
group tag, where N is the total number of columns. The number of columns is
variable since if the signature has no contributions for all samples, it is
completely omitted.</p>
<p>Note that the last column <code class="codehilite"><span class="err">tissue</span></code> is a misnomer. It aligns to the arbitrary
tag given in the <a href="#sample-sheet">sample sheet</a>.</p>
<h5>Example</h5>

<table>
<thead>
<tr>
<th></th>
<th align="right">Signature.1</th>
<th align="right">Signature.2</th>
<th align="center">…</th>
<th align="right">Signature.30</th>
<th>tissue</th>
</tr>
</thead>
<tbody>
<tr>
<td>SJACT001_D</td>
<td align="right">1.71758029</td>
<td align="right">131.033723</td>
<td align="center">…</td>
<td align="right">18.6910151</td>
<td>ACT</td>
</tr>
<tr>
<td>SJAMLM7005_D</td>
<td align="right">51.9627312</td>
<td align="right">7.10850351</td>
<td align="center">…</td>
<td align="right">0</td>
<td>AMLM7</td>
</tr>
</tbody>
</table>
<h4 id="signatures-visualization">Signatures visualization</h4>

<p><em>Signatures visualization</em> is an HTML file that can be used for interactive
plotting.</p>
<p>When opened in a web browser, a set of controls allows plotting various
stacked bar charts: total contributions by signature, total contributions by
tag, and total contributions by sample per tag. The total contributions can be
stacked as absolute values or as a percentage of the total.</p>
<h4 id="sample-sheet-out">Sample sheet</h4>

<p>When no sample sheet is given as an input, one is generated automatically,
but it is not guaranteed the derived tags will be of any use. This generated
sample sheet is given as an output in the case the tags need to be manually
edited, and the job is resubmitted with it as an input.</p>
<p>When a sample sheet is given as an input, the sample sheet output is a copy
of the input.</p>
<p>See also the description for the input <a href="#sample-sheet">sample sheet</a>.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>To troubleshoot a failed run of Mutational Signatures, check the job log for
details.</p>
<h3 id="wrong-genome-build">Wrong genome build</h3>

<p>If the "Building mutation matrix" step during <code class="codehilite"><span class="err">run</span></code> fails, it is likely that
the selected genome build does not match the input VCF(s). Rerun the job with
a matching genome build.</p>
<h4>Example</h4>

<div class="codehilite"><pre><span></span><code><span class="n">R</span><span class="o">:</span> <span class="n">Building</span> <span class="n">mutation</span> <span class="n">matrix</span> <span class="n">from</span> <span class="mi">6</span> <span class="n">VCFs</span>
<span class="n">R</span><span class="o">:</span> <span class="n">Error</span> <span class="k">in</span> <span class="n">mut_matrix</span><span class="o">(</span><span class="n">vcf_list</span> <span class="o">=</span> <span class="n">filtered_vcfs</span><span class="o">,</span> <span class="n">ref_genome</span> <span class="o">=</span> <span class="n">ref_genome</span><span class="o">)</span> <span class="o">:</span>
<span class="n">R</span><span class="o">:</span>   <span class="n">Error</span> <span class="k">in</span> <span class="o">.</span><span class="na">Call2</span><span class="o">(</span><span class="s2">&quot;solve_user_SEW&quot;</span><span class="o">,</span> <span class="n">refwidths</span><span class="o">,</span> <span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">,</span> <span class="n">width</span><span class="o">,</span> <span class="n">translate</span><span class="o">.</span><span class="na">negative</span><span class="o">.</span><span class="na">coord</span><span class="o">,</span>  <span class="o">:</span>
<span class="n">R</span><span class="o">:</span>   <span class="n">solving</span> <span class="n">row</span> <span class="mi">526</span><span class="o">:</span> <span class="s1">&#39;allow.nonnarrowing&#39;</span> <span class="k">is</span> <span class="n">FALSE</span> <span class="n">and</span> <span class="n">the</span> <span class="n">supplied</span> <span class="n">start</span> <span class="o">(</span><span class="mi">79440206</span><span class="o">)</span> <span class="k">is</span> <span class="o">&gt;</span> <span class="n">refwidth</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div>


<h2 id="references">References</h2>
<ul>
<li>Blokzijl F, Janssen R, van Boxtel R, Cuppen E (2018). "MutationalPatterns:
    comprehensive genome-wide analysis of mutational processes." <em>Genome
    Medicine</em>. doi: <a href="https://doi.org/10.1186/s13073-018-0539-0">10.1186/s13073-018-0539-0</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/29695279">29695279</a>.</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../warden/" title="WARDEN Differential Expression Analysis" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                WARDEN Differential Expression Analysis
              </span>
            </div>
          </a>
        
        
          <a href="../cis-x/" title="" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 - 2019 St. Jude Children's Research Hospital
          </div>
        
        
        built from <a href="https://github.com/stjudecloud/docs/tree/d86eec9">d86eec9</a> using
        
        <a href="https://www.mkdocs.org">MkDocs</a>
        and a modified version of
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>.
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://www.facebook.com/stjuderesearch/" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://twitter.com/stjuderesearch?lang=en" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/st-jude-childrens-research-hospital" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://github.com/stjude" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.ec5be3af.js"></script>
      
      <script>app.initialize({version:"0.17.4",url:{base:"../../.."}})</script>
      
    
    
      
    
  </body>
</html>